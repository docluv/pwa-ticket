"use strict";!function(){function t(){_d.qs(".navbar-toggler").addEventListener("click",function(){!function(){if(document.body.clientWidth<992){var e=document.getElementById("navbarNav");e.classList.toggle("show")}}()})}window.pwaTickets={getParameterByName:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}};var n="";-1===window.location.href.indexOf("login")&&pwaTicketAPI.verifyToken().then(function(e){e?(document.body.classList.add("authenticated"),pwaTicketAPI.loadTemplate("templates/event-list.html").then(function(e){if(e){n=e;var t=_d.qs(".search-input");t.addEventListener("keyup",function(e){return e.preventDefault(),(3<t.value.length||13===e.keyCode)&&pwaTicketAPI.searchFutureEvents(t.value).then(function(e){_d.qs(".content-target").innerHTML=Mustache.render(n,{events:e})}),!1})}}).catch(function(){}),t(),_d.qs(".logout-btn").addEventListener("click",function(e){return e.preventDefault(),pwaTicketAPI.logout(),!1})):window.location.href="login"}),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(function(){}).catch(function(){})}();


var deferredPrompt;

window.addEventListener('beforeinstallprompt', function (e) {
  // Prevent Chrome 67 and earlier from automatically showing the prompt
  e.preventDefault();
  // Stash the event so it can be triggered later.
  deferredPrompt = e;

  showAddToHomeScreen();

});

function showAddToHomeScreen() {

var a2hsBtn = document.querySelector(".ad2hs-prompt");

a2hsBtn.style.display = "flex";

a2hsBtn.addEventListener("click", addToHomeScreen);

}

function addToHomeScreen() {

  var a2hsBtn = document.querySelector(".ad2hs-prompt");

  // hide our user interface that shows our A2HS button
  a2hsBtn.style.display = 'none';

  if (deferredPrompt) {
    // Show the prompt
    deferredPrompt.prompt();

    // Wait for the user to respond to the prompt
    deferredPrompt.userChoice
      .then(function (choiceResult) {

        if (choiceResult.outcome === 'accepted') {
          console.log('User accepted the A2HS prompt');
        } else {
          console.log('User dismissed the A2HS prompt');
        }

        deferredPrompt = null;

      });

  }

}

//    showAddToHomeScreen();

window.addEventListener('appinstalled', function (evt) {
  console.log('a2hs', 'installed');
});
