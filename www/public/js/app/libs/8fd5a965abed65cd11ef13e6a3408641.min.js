"PushManager"in window&&(window.pushMgr={swRegistration:void 0,_isSubscribed:!1,askPermission:function(){return new Promise(function(i,n){var e=Notification.requestPermission(function(n){i(n)});e&&e.then(i,n)})},updateSubscriptionOnServer:function(){},getSubscription:function(){return navigator.serviceWorker.getRegistration().then(function(n){return n.pushManager.getSubscription()})},getIsSubscribed:function(){var e=this;return new Promise(function(i){e.getSubscription().then(function(n){e._isSubscribed=n,i(e._isSubscribed)})})},initialisePush:function(){var i=this;i.swRegistration&&i.getSubscription().then(function(n){n||i.subscribeUser()})},urlB64ToUint8Array:function(n){for(var i=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),e=window.atob(i),t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t},unsubscribeUser:function(){var n=this;n.getSubscription().then(function(n){return n.unsubscribe()}).catch(function(){}).then(function(){n.updateSubscriptionOnServer(null),n.isSubscribed=!1})},subscribeUser:function(){var i=this;i.getIsSubscribed().then(function(){i.askPermission().then(function(n){n&&i.swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:i.urlB64ToUint8Array(applicationServerPublicKey)}).then(function(n){i.updateSubscriptionOnServer(n),i._isSubscribed=!0}).catch(function(){})})})}});