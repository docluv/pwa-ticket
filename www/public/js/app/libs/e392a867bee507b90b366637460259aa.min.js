var pwaTicketAPI=function(){var r="http://localhost:15501/",n="auth-token";return{loadTemplate:function(t){return fetch(t).then(function(t){if(t.ok)return t.text().then(function(t){return t})})},searchFutureEvents:function(t){return fetch(r+"futureEvents?q="+t).then(function(t){if(t.ok)return t.json();throw"user tickets fetch failed"})},getUserTickets:function(t){return fetch(r+"users/"+t).then(function(t){if(t.ok)return t.json().then(function(t){return t.tickets});throw"user tickets fetch failed"})},getUserTicket:function(t,e){return fetch(r+"users/"+t).then(function(t){if(t.ok)return t.json().then(function(t){return t.tickets.filter(function(t){return t.id===e})[0]});throw"user tickets fetch failed"})},getTicket:function(t){return fetch(r+"tickets/"+t).then(function(t){if(t.ok)return t.json();throw"user tickets fetch failed"})},getEventTicket:function(t,n){return fetch(r+"futureEvents/"+t).then(function(t){if(t.ok)return t.json().then(function(t){var e=t["available-tickets"].filter(function(t){return t.id===n});return(e=e[0]).event={id:t.id,title:t.title,venue:t.venue,date:t.date,city:t.city,state:t.state,image:t.image},e});throw"user tickets fetch failed"})},getUser:function(t){return fetch(r+"users/"+t).then(function(t){if(t.ok)return t.json();throw"user tickets fetch failed"})},getFutureEvents:function(){return fetch(r+"futureEvents/").then(function(t){if(t.ok)return t.json();throw"user tickets fetch failed"})},getEvent:function(t,e){return void 0===e&&(e=!0),fetch(r+(e?"futureEvents/":"pastEvents/")+t).then(function(t){if(t.ok)return t.json().then(function(t){for(var e=0;e<t["available-tickets"].length;e++)t["available-tickets"][e].eventid=t.id;return t});throw"user tickets fetch failed"})},postContact:function(t){return fetch(r+"contacts/",{method:"POST",cache:"no-cache",headers:{"content-type":"application/json"},mode:"cors",body:JSON.stringify(t)})},updateUser:function(t){return fetch({method:"POST","Content-Type":"application/json",body:JSON.stringify(t),url:r+"users/"})},buyTicket:function(e){return this.verifyToken().then(function(t){return fetch(r+"user/"+t.id+"/tickets/",{method:"POST",cache:"no-cache",headers:{"content-type":"application/json"},mode:"cors",body:JSON.stringify(e)})})},verifyToken:function(){return localforage.getItem(n).then(function(t){if(t)return pwaTicketAPI.token=t;window.location.href="login"})},login:function(t){return fetch(r+"users/?userName="+t.username+"&password="+t.password).then(function(t){if(t.ok)return t.json().then(function(t){if(0<t.length)return e=t[0],localforage.setItem(n,e).then(function(){return e});var e});throw"user tickets fetch failed"})},logout:function(){localforage.removeItem(n).then(function(){window.location.href="login"})}}}();